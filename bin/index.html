<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8"/>
	<title>DCI - Library machine</title>
	<link rel="stylesheet" href="https://cdn.concisecss.com/concise.css">
	<link rel="stylesheet" href="https://cdn.concisecss.com/concise-ui/concise-ui.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/dragula/3.7.2/dragula.css">
	<link rel="stylesheet" href="css/styles.css">
</head>
<body>
	<div grid="bottom">
		<div column>
			<div id="bookshelf"></div>
		</div>
	</div>
	<div grid="bottom">
		<div column='3'>
			<div id="printer"></div>
		</div>
		<div column='6'>
			<div id="screen"></div>
		</div>
		<div column='2'>
			<div id="card-reader"></div>
		</div>
	</div>
	<div grid>
		<div column='8 +2'>
			<div id="table">
				<div id="workspace"></div>
				<div id="scanner"></div>
			</div>
		</div>
	</div>
	<script src="https://unpkg.com/mithril/mithril.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/dragula/3.7.2/dragula.js"></script>
	<script>
		/*
		function q(query) { return document.querySelector(query) }

		function removeFirst(arr, predicate) {
		    for (var i = 0; i < arr.length; i++) {
		        if (predicate(arr[i])) {
		            return arr.splice(i--, 1)[0];
		        }
		    }
		    return null
		}

		var bookshelf = q('#bookshelf')
		var booksOnShelf = ['Anna Karenina', 'War and Peace', 'Master and Man']
		var booksOnWorkspace = []

		dragula([bookshelf, q('#workspace'), q('#scanner'), q('#card-reader')], {
			accepts: function (el, target, source, sibling) {
				var isCard = el.id == "card"
				return (isCard && target.id != "bookshelf") ||
					   (!isCard && !target.classList.contains("card-reader"))
			}
		}).on('drop', function(el, target, source, sibling) {
			console.log(el)
			console.log(target)

			if(el.classList.contains('book')) {
				var from = source.id == "workspace" ? booksOnWorkspace : booksOnShelf
				var to = target.id == "workspace" ? booksOnWorkspace : booksOnShelf
				to.push(removeFirst(from, function(book) { return book.id == el.innerText }))

				console.log(to)
			}
		})

		m.render(bookshelf, booksOnShelf.map(function(book) {
			return m('.book', book)
		}))
		*/
	</script>
	<script src="haxedci-example.js"></script>
	<script>
	  if(location.hostname === "localhost") document.write('<script src="http://' + (location.host || 'localhost').split(':')[0] +
	  ':35729/livereload.js?snipver=1"></' + 'script>')
	</script> 
</body>
</html>